╔═══════════════════════════════════════════════════════════════════════════╗
║           ESP32-S3 PLANT WATERING SYSTEM - VERKABELUNGSDIAGRAMM           ║
║                         *** AKTUALISIERT FÜR ESP32-S3 ***                 ║
╚═══════════════════════════════════════════════════════════════════════════╝

┌─────────────────────────────────────────────────────────────────────────┐
│                          BODENFEUCHTESENSOREN                             │
└─────────────────────────────────────────────────────────────────────────┘

    Sensor 1              Sensor 2              Sensor 3              Sensor 4
    ┌──────┐              ┌──────┐              ┌──────┐              ┌──────┐
    │ VCC  ├──────────────┤ VCC  ├──────────────┤ VCC  ├──────────────┤ VCC  │───► 3.3V
    │ GND  ├──────────────┤ GND  ├──────────────┤ GND  ├──────────────┤ GND  │───► GND
    │ AOUT │              │ AOUT │              │ AOUT │              │ AOUT │
    └───┬──┘              └───┬──┘              └───┬──┘              └───┬──┘
        │                     │                     │                     │
        ▼                     ▼                     ▼                     ▼
    GPIO 1                GPIO 2                GPIO 5                GPIO 6
      (ADC1_CH0)            (ADC1_CH1)            (ADC1_CH4)            (ADC1_CH5)

    ⚠️  WICHTIG: ESP32-S3 ADC1 = GPIO 1-10 (WiFi kompatibel!)
                ADC2 = GPIO 11-20 funktioniert NICHT mit WiFi!

┌─────────────────────────────────────────────────────────────────────────┐
│                          DHT11 SENSOR                                     │
└─────────────────────────────────────────────────────────────────────────┘

         DHT11
       ┌──────┐
       │ VCC  │───────────► 3.3V
       │      │
       │ DATA │─────┬──────► GPIO 7
       │      │     │
       │ GND  │───┐ │
       └──────┘   │ │
                  │ └────────► 10kΩ ──► 3.3V (Pull-up)
                  └──────────► GND

┌─────────────────────────────────────────────────────────────────────────┐
│                    ULTRASCHALLSENSOR (HC-SR04)                            │
└─────────────────────────────────────────────────────────────────────────┘

      HC-SR04
     ┌────────┐
     │  VCC   │───────────► 5V
     │  TRIG  │───────────► GPIO 8
     │        │
     │  ECHO  │────┐
     │        │    │       SPANNUNGSTEILER (5V → 3.3V):
     │  GND   │──┐ │       ┌─── 2kΩ ────┬──► GPIO 9 (3.3V)
     └────────┘  │ └───────┤            │
                 │         └─── 1kΩ ────┴──► GND
                 └─────────────────────────► GND

    ⚠️  WICHTIG: HC-SR04 ECHO gibt 5V aus!
                Spannungsteiler ist ZWINGEND erforderlich!

┌─────────────────────────────────────────────────────────────────────────┐
│                    4-KANAL RELAIS + PUMPEN                                │
└─────────────────────────────────────────────────────────────────────────┘

    ESP32                      RELAIS MODUL                    PUMPEN
  ┌────────┐                 ┌────────────┐
  │ GPIO10 ├─────────────────┤ IN1        │
  │ GPIO11 ├─────────────────┤ IN2        │
  │ GPIO12 ├─────────────────┤ IN3        │
  │ GPIO13 ├─────────────────┤ IN4        │
  │   5V   ├─────────────────┤ VCC        │
  │  GND   ├─────────────────┤ GND        │
  └────────┘                 │            │
                             │ JD-VCC ────┼───► 12V (+)
                             │            │
     12V Netzteil            │  COM   ────┼───► 12V (+)
    ┌──────────┐             │            │
    │    +     │─────────────┤ NO1    ────┼───► Pumpe 1 (+)
    │          │             │ NO2    ────┼───► Pumpe 2 (+)
    │    -     │──┬──────────┤ NO3    ────┼───► Pumpe 3 (+)
    └──────────┘  │          │ NO4    ────┼───► Pumpe 4 (+)
                  │          └────────────┘
                  │
                  ├────────────────────────────► Pumpe 1 (-)
                  ├────────────────────────────► Pumpe 2 (-)
                  ├────────────────────────────► Pumpe 3 (-)
                  └────────────────────────────► Pumpe 4 (-)

    ⚠️  WICHTIG: Jumper zwischen VCC und JD-VCC am Relais entfernen!
                JD-VCC mit externem 12V versorgen für Pumpen!

┌─────────────────────────────────────────────────────────────────────────┐
│                    E-INK DISPLAY (SPI)                                    │
└─────────────────────────────────────────────────────────────────────────┘

    Waveshare 1.54" E-Ink
       ┌──────────┐
       │   VCC    │───────────► 3.3V
       │   GND    │───────────► GND
       │   DIN    │───────────► GPIO 35 (MOSI)
       │   CLK    │───────────► GPIO 36 (SCK)
       │    CS    │───────────► GPIO 38
       │    DC    │───────────► GPIO 39
       │   RST    │───────────► GPIO 40
       │   BUSY   │───────────► GPIO 41
       └──────────┘

    HINWEIS: SPI Pins können in main.py angepasst werden.
             Standard ESP32-S3 SPI: MOSI=35, SCK=36

┌─────────────────────────────────────────────────────────────────────────┐
│                    STROMVERSORGUNG                                        │
└─────────────────────────────────────────────────────────────────────────┘

    ┌─────────────┐
    │  USB-C 5V   │───────────► ESP32-S3 (via USB-C Port)
    └─────────────┘

    ┌─────────────┐
    │   12V DC    │───────────► Relais JD-VCC
    │  Netzteil   │───────────► Pumpen (via Relais)
    └─────────────┘

    Empfohlene Leistung: 12V, 2A (24W)

┌─────────────────────────────────────────────────────────────────────────┐
│                    PIN-BELEGUNG ZUSAMMENFASSUNG                           │
└─────────────────────────────────────────────────────────────────────────┘

    GPIO 1  ──► Moisture Sensor 1 (ADC1_CH0) ✅ WiFi-sicher
    GPIO 2  ──► Moisture Sensor 2 (ADC1_CH1) ✅ WiFi-sicher
    GPIO 5  ──► Moisture Sensor 3 (ADC1_CH4) ✅ WiFi-sicher
    GPIO 6  ──► Moisture Sensor 4 (ADC1_CH5) ✅ WiFi-sicher
    GPIO 7  ──► DHT11 DATA
    GPIO 8  ──► Ultrasonic TRIG
    GPIO 9  ──► Ultrasonic ECHO (mit Spannungsteiler!)
    GPIO 10 ──► Relais IN1 (Pumpe 1)
    GPIO 11 ──► Relais IN2 (Pumpe 2)
    GPIO 12 ──► Relais IN3 (Pumpe 3)
    GPIO 13 ──► Relais IN4 (Pumpe 4)
    GPIO 35 ──► E-Ink DIN (MOSI)
    GPIO 36 ──► E-Ink CLK (SCK)
    GPIO 38 ──► E-Ink CS
    GPIO 39 ──► E-Ink DC
    GPIO 40 ──► E-Ink RST
    GPIO 41 ──► E-Ink BUSY

┌─────────────────────────────────────────────────────────────────────────┐
│                ESP32-S3 PIN-KOMPATIBILITÄT WICHTIG!                       │
└─────────────────────────────────────────────────────────────────────────┘

    ✅ ADC1 (GPIO 1-10):  MIT WiFi kompatibel - für Moisture Sensors!
    ❌ ADC2 (GPIO 11-20): NICHT mit WiFi kompatibel - vermeiden!
    ⚠️  GPIO 0, 3:        Strapping Pins - nicht für kritische Sensoren!
    ⚠️  GPIO 19, 20:      USB Pins - nicht verwenden!
    ✅ GPIO 21-48:        Frei verwendbar für digitale I/O

    EMPFEHLUNG:
    - Analoge Sensoren:   GPIO 1-10 (ADC1)
    - Digitale I/O:       GPIO 10-18, 21+
    - Kritische Signale:  GPIO 21+ (keine Strapping Pins)

┌─────────────────────────────────────────────────────────────────────────┐
│                    VERKABELUNGS-CHECKLISTE                                │
└─────────────────────────────────────────────────────────────────────────┘

    □ Alle 3.3V Verbindungen an ESP32 3.3V Pin
    □ Alle GND Verbindungen an ESP32 GND Pin
    □ Moisture Sensors an GPIO 1, 2, 5, 6 (ADC1!) angeschlossen
    □ DHT11 an GPIO 7 + Pull-up Widerstand (10kΩ) installiert
    □ Ultraschall TRIG an GPIO 8
    □ Ultraschall ECHO an GPIO 9 mit Spannungsteiler (2kΩ + 1kΩ)
    □ Relais IN1-IN4 an GPIO 10-13 angeschlossen
    □ Relais VCC an ESP32 5V angeschlossen
    □ Relais JD-VCC an externes 12V Netzteil angeschlossen
    □ Jumper zwischen VCC und JD-VCC am Relais ENTFERNT
    □ E-Ink Display an GPIO 35, 36, 38-41 (falls verwendet)
    □ Alle Pumpen korrekt gepolt (+ an NO, - an 12V GND)
    □ 12V Netzteil hat ausreichende Leistung (min. 2A)
    □ Alle Kabelverbindungen fest und isoliert
    □ Keine Kurzschlüsse zwischen + und - Leitungen

┌─────────────────────────────────────────────────────────────────────────┐
│                    SICHERHEITSHINWEISE                                    │
└─────────────────────────────────────────────────────────────────────────┘

    ⚠️  ESP32-S3 verträgt MAXIMAL 3.3V an GPIO-Pins!
    ⚠️  Ultraschall ECHO gibt 5V aus → Spannungsteiler ZWINGEND!
    ⚠️  ADC2 (GPIO 11-20) funktioniert NICHT mit aktivem WiFi!
    ⚠️  Relais-Spulen benötigen separate 12V Versorgung (JD-VCC)
    ⚠️  Pumpen dürfen nicht trocken laufen → Mindest-Wasserstand!
    ⚠️  Elektronik vor Feuchtigkeit schützen
    ⚠️  Vor Wartung: Stromversorgung trennen!

┌─────────────────────────────────────────────────────────────────────────┐
│                    UNTERSCHIEDE ZU KLASSISCHEM ESP32                      │
└─────────────────────────────────────────────────────────────────────────┘

    ESP32 (alt)           ESP32-S3 (neu)          Grund
    ───────────────────────────────────────────────────────────────────────
    GPIO 36 (ADC)    →    GPIO 1 (ADC1_CH0)     S3 hat andere ADC-Pins
    GPIO 39 (ADC)    →    GPIO 2 (ADC1_CH1)     S3 hat andere ADC-Pins
    GPIO 34 (ADC)    →    GPIO 5 (ADC1_CH4)     S3 hat andere ADC-Pins
    GPIO 35 (ADC)    →    GPIO 6 (ADC1_CH5)     S3 hat andere ADC-Pins
    GPIO 4 (DHT)     →    GPIO 7 (DHT)          Konflikt vermeiden
    GPIO 5 (TRIG)    →    GPIO 8 (TRIG)         Konflikt vermeiden
    GPIO 18 (ECHO)   →    GPIO 9 (ECHO)         Konflikt vermeiden

    WARUM?: ESP32-S3 ADC1 = GPIO 1-10 (WiFi-kompatibel!)
            ESP32-S3 ADC2 = GPIO 11-20 (NICHT WiFi-kompatibel!)

╔═══════════════════════════════════════════════════════════════════════════╗
║                    VIEL ERFOLG MIT IHREM PROJEKT!                         ║
╚═══════════════════════════════════════════════════════════════════════════╝
